# CMake Example Project

*TODO: This document is a work in progress*

The CMake example project for using the Live SketchUp C API is made to reasonable simulate a real world project.

It's not intended for beginners, familiarity with C++, compiling, Visual Studio, Xcode and CMake is expected.

The project is liberally commented around key aspects to inform about why things are set up the way they are.

## Requirements

It might be possible to use older versions for some of this, but it has not been tested.

The project has also mainly been tested as a Visual Studio Code project.

* CMake 3.17 or newer
* Visual Studio 2019
* XCode 10.3 (Clang 10)
* Ruby 2.3 or newer

*Remember to also checkout the git submodules!*

```sh
git submodule update --init
```

## Project Structure

*TODO: Project structure*

## Getting started with VSCode and CMake

Upon opening the project in VSCode the editor will prompt to install any necessary VSCode extensions that might be missing.

Once open, choose your CMake toolkit.

![](images/vscode-cmake-toolkit.png)

The following toolkits have been used while developing this example project:

* Visual Studio Professional 2019 Release - amd64
* Clang 10.0.1

## Configuration

The SketchUp C API is not included in this repository. It must be downloaded separately from the [Developer Portal](https://developer.sketchup.com/).

Download the ZIP file for your platform to a directory; for example `"C:/Users/<username>/SLAPI"`.

While unpacking, make sure the files are extracted to a directory that matches the base name of the ZIP.

![](images/sdk-locations.png)

Then add that path to the CMake environment variables with the key `SketchUpAPI_SEARCH_DIR`.

The project will look for an appropriate SDK package in the path given by `SketchUpAPI_SEARCH_DIR` using the name of the directories to determine what version they represent.

You can set up this variable from VSCode for convenience:

`<Command Palette>` » Preferences: Open Settings (JSON)

```json
{
  "cmake.environment": {
      "SketchUpAPI_SEARCH_DIR": "C:/Users/<username>/SLAPI"
  }
}
```

After that is set up you should be able to invoke a successful CMake configuration:

`<Command Palette>` » CMake: Configure

## Building

`<Command Palette>` » CMake: Build

## Running Tests

To run the tests you can invoke CTest and see the results in the VSCode Output panel.

`<Command Palette>` » CMake: Run Tests

![](images/vscode-cmake-ctest.png)

Alternatively, the VSCode Test Runner extension can be used for easy granular control. It also provides easy access to debug or rerun specific tests.

![](images/vscode-cmake-testrunner.png)

## Debugging

Besides using the Test Runner in VSCode to run and debug tests, debugging of executables generated by the CMake project can be invoked via:

`<Command Palette>` » CMake: Debug

You might need to set the debug target first:

`<Command Palette>` » CMake: Set Debug Targets

The debugger should break on the break point set in the VSCode editor.

![](images/vscode-cmake-debug.png)

## Running/Debugging the Ruby Extension

*Make sure to run `bundle install` to ensure all required gems are installed.*

*TODO: Running Ruby Extension*

*TODO: Adding repository paths to SketchUp*

### Running the Ruby Extension

`<Command Palette>` » Tasks: Run Task » Launch SketchUp in Ruby Debug mode

`<Command Palette>` » Tasks: Rerun Task

### Debugging Ruby C-Extension

### Debugging Ruby Code

https://github.com/SketchUp/sketchup-ruby-debugger
